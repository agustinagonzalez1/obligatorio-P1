{
    "sourceFile": "js/script.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1717767120495,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1717767120495,
            "name": "Commit-0",
            "content": "let contadorAdministradores = 1;\r\nlet sigIDUsuarios = 1;\r\n\r\nclass Sistema {\r\n    constructor() {\r\n        this.listaAdministradores = [\r\n            new Administrador(\"juan\", \"juan123\"),\r\n            new Administrador(\"pedro\", \"pedro123\"),\r\n        ];\r\n        this.listaCompradores = [\r\n            new Usuario(\"Prince\", \"Nelson\", \"Prince.Nelson\", \"Prince1234\", \"79927398712\", \"012\"),\r\n            new Usuario(\"Hideo\", \"Kojima\", \"Hideo.Kojima\", \"Hideo1234\", \"79927398712\", \"013\"),\r\n            new Usuario(\"Bob\", \"Esponja\", \"Bob.Esponja\", \"Bob1234\", \"79927398712\", \"014\"),\r\n        ];\r\n        this.listaProductos = [];\r\n        this.listaCompras = [];\r\n    }\r\n\r\n    buscarUsuarioGeneral(nombreDeUsuario) {\r\n        let usuarioBuscado = null;\r\n        let tipo = null;\r\n        \r\n        for (let i = 0; i < this.listaAdministradores.length; i++) {\r\n            const unAdmin = this.listaAdministradores[i];\r\n            if (unAdmin.usuario.toLowerCase() === nombreDeUsuario.toLowerCase()) {\r\n                usuarioBuscado = unAdmin;\r\n                tipo = 'admin';\r\n                break;\r\n            }\r\n        }\r\n        \r\n        if (usuarioBuscado === null) {\r\n            for (let i = 0; i < this.listaCompradores.length; i++) {\r\n                const unUsuario = this.listaCompradores[i];\r\n                if (unUsuario.usuario.toLowerCase() === nombreDeUsuario.toLowerCase()) {\r\n                    usuarioBuscado = unUsuario;\r\n                    tipo = 'comprador';\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        \r\n        return { usuario: usuarioBuscado, tipo: tipo };\r\n    }\r\n}\r\n\r\nclass Administrador {\r\n    constructor(usuario, password) {\r\n        this.id = contadorAdministradores;\r\n        this.usuario = usuario;\r\n        this.password = password;\r\n        contadorAdministradores++;\r\n    }\r\n}\r\n\r\nclass Usuario {\r\n    constructor(unNombre, unApellido, unUsuario, unaPass, unaTarjCred, unCVC) {\r\n        this.nombre = unNombre;\r\n        this.apellido = unApellido;\r\n        this.usuario = unUsuario;\r\n        this.password = unaPass;\r\n        this.TarjCred = unaTarjCred;\r\n        this.cvc = unCVC;\r\n        sigIDUsuarios++;\r\n    }\r\n}\r\n\r\n// Poner las otras clases\r\n\r\nlet sistema = new Sistema();\r\ninicio();\r\n\r\nfunction inicio() {\r\n    ocultarTodo();\r\n    document.querySelector(\"#pantallaLogin\").style.display = \"block\"; //esto muestra el login\r\n    document.querySelector(\"#btnLoginComprador\").addEventListener(\"click\", hacerLogin);\r\n}\r\n\r\nfunction ocultarTodo() { //eso esconde un elemento, que no se muestre\r\n    document.querySelector(\"#navPrincipal\").style.display = \"none\";\r\n    document.querySelector(\"#pantallaLogin\").style.display = \"none\";\r\n    document.querySelector(\"#navPrincipalComprador\").style.display = \"none\";\r\n}\r\n\r\nfunction hacerLogin() {\r\n    // Capturar los datos\r\n    let usuario = document.querySelector(\"#txtLoginUsuario\").value;\r\n    let password = document.querySelector(\"#txtPass\").value;\r\n    \r\n    // Obtener un usuario con ese nombre de usuario\r\n    let resultadoBusqueda = sistema.buscarUsuarioGeneral(usuario);\r\n    let usuarioBuscado = resultadoBusqueda.usuario;\r\n    let tipoUsuario = resultadoBusqueda.tipo;\r\n    \r\n    // Chequear si el user y password existen\r\n    if (usuarioBuscado != null) {\r\n        if (usuarioBuscado.password === password) {\r\n            alert(\"Login ok\");\r\n            if (tipoUsuario === 'admin') {\r\n                // Mostrar menú de administrador\r\n                mostrarMenuAdmin();\r\n            } else if (tipoUsuario === 'comprador') {\r\n                // Mostrar menú de comprador\r\n                mostrarMenuComprador();\r\n            }\r\n        } else {\r\n            alert(\"Password incorrecto\");\r\n        }\r\n    } else {\r\n        alert(\"No existe un usuario con ese nombre de usuario\");\r\n    }\r\n}\r\n\r\nfunction mostrarMenuAdmin() {\r\n    ocultarTodo();\r\n    document.querySelector(\"#navPrincipal\").style.display = \"block\"; // Mostrar menú de admin\r\n}\r\n\r\nfunction mostrarMenuComprador() {\r\n    ocultarTodo();\r\n    document.querySelector(\"#navPrincipalComprador\").style.display = \"block\"; // Mostrar menú de comprador\r\n}\r\n\r\nfunction validarContrasena(password){\r\n    if (password.length <5 ){\r\n        return false;\r\n    }\r\n    let tieneMayuscula= false;\r\n    let tieneMinuscula=false;\r\n    let tieneNumero=false;\r\n\r\n    for(let i=0; i< password.length; i++){\r\n        const charCode = password.charCodeAt(i);\r\n\r\n        if (charCode >= 65 && charCode <= 90) {\r\n            tieneMayuscula = true;\r\n        }\r\n        // Verificar minúscula\r\n        else if (charCode >= 97 && charCode <= 122) {\r\n            tieneMinuscula = true;\r\n        }\r\n        // Verificar número\r\n        else if (charCode >= 48 && charCode <= 57) {\r\n            tieneNumero = true;\r\n        }\r\n        \r\n    }\r\n    return tieneMayuscula && tieneMinuscula && tieneNumero\r\n}\r\n\r\nfunction agregarUsuario(nombre, apellido, username, password, tarjeta) {\r\n    let newUser = new Usuario(nombre, apellido, username, password, tarjeta);\r\n    sistema.listaCompradores.push(newUser);\r\n}\r\n\r\n\r\n\r\nfunction luhnCheck(TarjCred) {\r\n    let sum = 0; \r\n    let numDigits = TarjCred.length;\r\n    let parity = numDigits % 2;\r\n\r\n    for (let i = 0; i < numDigits; i++) {\r\n        let digit = Number(TarjCred.charAt(i));\r\n\r\n        if (i % 2 === parity) digit *= 2;\r\n        if (digit > 9) digit -= 9;\r\n        sum += digit;\r\n    }\r\n    return sum % 10 === 0;\r\n}\r\n"
        }
    ]
}